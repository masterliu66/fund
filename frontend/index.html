<html>
  <head>
    <title>åŸºé‡‘æŸ¥è¯¢</title>
    <style>
      th:nth-child(2), td:nth-child(2) {
        min-width: 300px;
        text-align: left;
        padding-left: 15px
      }

      body {
        font-family: Arial;
        background: #667eea;
        color: white;
        padding: 20px
      }

      .container {
        max-width: 1600px;
        margin: 0 auto; padding: 0 20px
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        color: black
      }

      th, td {
        min-width: 68px;
        padding: 10px;
        border: 1px solid #ddd;
        text-align: center
      }

      th {
        background: #667eea;
        color: white
      }
    </style>
  </head>
  <body>
    <div class="container"><h1>ğŸ“Š åŸºé‡‘æ•°æ®æŸ¥è¯¢</h1>
      <button onclick="loadData()">åŠ è½½æ•°æ®</button>
      <input id="search" placeholder="æœç´¢åŸºé‡‘ä»£ç ">
      <button onclick="search()">æœç´¢</button>
      <table id="table" style="display:none">
        <thead>
        <tr>
          <th>ä»£ç </th>
          <th>åç§°</th>
          <th>å†å²æœ€é«˜</th>
          <th>å†å²æœ€ä½</th>
          <th>TP20</th>
          <th>TP80</th>
          <th>TP15</th>
          <th>TP85</th>
          <th>1å¹´æœ€é«˜</th>
          <th>1å¹´æœ€ä½</th>
          <th>90å¤©æœ€é«˜</th>
          <th>90å¤©æœ€ä½</th>
          <th>ä¸Šæœˆæœ€é«˜</th>
          <th>ä¸Šæœˆæœ€ä½</th>
          <th>æœ¬æœˆæœ€é«˜</th>
          <th>æœ¬æœˆæœ€ä½</th>
          <th>å½“æ—¥ä¼°å€¼</th>
          <th>å½“æ—¥æ¶¨å¹…</th>
        </tr>
        </thead>
        <tbody id="body"></tbody>
      </table>
      <div id="msg"></div>
    </div>
    <script>
      const API = window.location.origin;

      function loadData() {
        fetch(API + "/fund").then(r => r.json()).then(d => {
          if (d.code === 0) {
            show(d.data)
          } else {
            msg("å¤±è´¥")
          }
        }).catch(e => msg("é”™è¯¯: " + e.message))
      }

      function search() {
        const c = document.getElementById("search").value;
        if (!c) {
          msg("è¯·è¾“å…¥ä»£ç ");
          return
        }
        fetch(API + "/funds/" + c).then(r => r.json()).then(d => {
          if (d.code === 0) {
            show(d.data)
          } else {
            msg("å¤±è´¥")
          }
        }).catch(e => msg("é”™è¯¯: " + e.message))
      }

      function show(d) {
        const body = document.getElementById("body");
        body.innerHTML = "";
        d.forEach(item => {
          const row = document.createElement("tr");
          row.innerHTML = `<td>${item.FundCode}</td>
                           <td>${item.Name}</td>
                           <td>${fmt(item.HistoryMaxDwjz)}</td>
                           <td>${fmt(item.HistoryMinDwjz)}</td>
                           <td>${fmt(item.Tp80MinDwjz)}</td>
                           <td>${fmt(item.Tp80MaxDwjz)}</td>
                           <td>${fmt(item.Tp85MinDwjz)}</td
                           ><td>${fmt(item.Tp85MaxDwjz)}</td>
                           <td>${fmt(item.LastYearMaxDwjz)}</td>
                           <td>${fmt(item.LastYearMinDwjz)}</td>
                           <td>${fmt(item.LastSeasonMaxDwjz)}</td>
                           <td>${fmt(item.LastSeasonMinDwjz)}</td>
                           <td>${fmt(item.LastMonthMaxDwjz)}</td>
                           <td>${fmt(item.LastMonthMinDwjz)}</td>
                           <td>${fmt(item.MaxDwjz)}</td>
                           <td>${fmt(item.MinDwjz)}</td>
                           <td>${fmt(item.Gsz)}</td>
                           <td>${item.GszzlFormat}</td>`;
          body.appendChild(row)
        });
        document.getElementById("table").style.display = "table"
      }

      function fmt(n) {
        return n ? parseFloat(n).toFixed(4) : "-"
      }

      function msg(m) {
        document.getElementById("msg").textContent = m
      }

      window.addEventListener("load", loadData);
    </script>
  </body>
</html>
